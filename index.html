<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Login</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-[#FFF5E1] text-[#3E2723] flex justify-center items-center h-screen">

  <div class="bg-white p-8 rounded shadow max-w-md w-full">
    <h2 class="text-2xl font-bold text-center mb-6 text-[#3B82F6]">Artist Login</h2>

    <form id="loginForm" class="space-y-4">
      <input type="email" name="email" required placeholder="Email"
        class="w-full border px-4 py-2 rounded" />

      <div>
        <input type="password" name="password" id="passwordInput" required placeholder="Password"
          class="w-full border px-4 py-2 rounded" />
        <label class="text-sm mt-1 inline-flex items-center space-x-1">
          <input type="checkbox" onclick="togglePassword()" />
          <span>Show Password</span>
        </label>
      </div>

      <button type="submit"
        class="w-full bg-[#800000] hover:bg-[#A00000] text-white py-2 rounded">Login</button>
    </form>

    <p id="errorMsg" class="text-red-600 text-sm mt-4 hidden text-center"></p>
  </div>

  <script>
    const LOGIN_APP_URL = "https://script.google.com/macros/s/AKfycbzP8M8EtApZpDVo0sfeh5yIAsJ0LFu3gntNn3kAmo0aZyOTzH_2eqpUIHZMK6Edt11g2Q/exec";

    document.getElementById("loginForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const form = e.target;
      const email = form.email.value.trim();
      const password = form.password.value.trim();
      const errorMsg = document.getElementById("errorMsg");

      try {
        const res = await fetch(LOGIN_APP_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ action: "login", email, password })
        });

        const result = await res.json();

        if (result.success) {
          localStorage.setItem("artistEmail", email);
          localStorage.setItem("sessionId", result.sessionId);
          window.location.href = "dashboard.html";
        } else {
          errorMsg.textContent = result.message || "Login failed.";
          errorMsg.classList.remove("hidden");
        }
      } catch (err) {
        errorMsg.textContent = "Error connecting to server.";
        errorMsg.classList.remove("hidden");
      }
    });

    function togglePassword() {
      const pwInput = document.getElementById("passwordInput");
      pwInput.type = pwInput.type === "password" ? "text" : "password";
    }
  </script>
</body>
</html>
